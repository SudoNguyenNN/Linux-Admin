### Kernel and grub

**Kernel**

Linux kernel là thành phần quan trọng của một [Linux operating system](https://github.com/utnguyen153s2/Linux_Basic/blob/master/Linux%20operating%20system.md) (OS) và là giao diện cốt lõi giữa phần cứng máy tính và các quá trình của nó.Nó quản lý tài nguyên một cách hiệu quả.

**grub** Viết tắt của GRand Unified Bootloader là một chương trình khởi động máy tín được  phát triển bởi dự án GNU.Là một chương trình bootloader rất quan trọng vì hệ điều hành không thể khởi động khi không có nó. Nó là chương trình đầu tiên được chạy khi chương trình bật lên. Bootloader chuyển quyền kiểm soát cho hạt nhân của hệ điều hành


### initrd

Trong máy tính (đặc biệt là liên quan đến Linux máy tính), initrd (initial ramdisk) là một chương trình cho tải một hệ thống tập tin gốc tạm thời và bộ nhớ. Mà có thể được sử dụng như một phần cửa Linux startup process.

initial ram disk (initrd) là một hệ thống tập tin tạm thời mà được gắn trong khi khởi động hệ thống để hỗ trợ quá trình khởi động tow-state. initrd chứa file thực thi khác nhau và trình điều khiển cho phép hệ thống tập tin gốc thực tế được gắn kết, sau khi mà initrd ram disk được gỡ bỏ và bộ nhớ của nó được giải phóng. Trong nhiều hệ thống nhúng, initrd là final root file system

### halt, reboot and poweroff

**halt, poweroff** và **reboot** là câu lệnh mà bạn cần chạy dưới quyền root để dừng hệ thốn phần cứng
- halt : chỉ thị phần cứng dừng tất cả các chức năng CPU
- poweroff: gửi một tín hiệu ACPI (ACPI Advanced Configuration and Power Interface: cung cấp tính năng quản lý điện năng cung cấp cho hệ thống) mà chỉ thị power down hệ thống
- reboot: chỉ thị reboot (reboot: là một quá trình khởi động lại một công việc của máy tính sử dụng phần cứng) hệ thống

### linux boot step

Dưới đây là 6 bước cơ bản, điển hình của một quá trình Linux boot

<img src="https://i.imgur.com/KY0dIQj.jpg">

- BIOS
  - BIOS viết tắt của Basic Input/Output System
  - Thực hiện một số kiểm tra toàn vẹn hệ thống
  - Tìm kiếm, tải và thực thi chương trình lạp khởi động
  - Nó tìm kiếm chương trình khởi động trong floppy, cd-rom hoặc ổ cứng. Bạn cần nhấn phím (thường là F12 of F2, nhưng nó phụ thuộc vào hệ thống của bạn) trong khi khởi động boot để thay đổi thứ tự boot.
  - Sau khi chương trình nạp được tìm thấy và được nạp vào bộ nhớ, BIOS cung cấp các điều khiển cho nó.
  => Tóm lại BOIS tải và thực hiện bộ nạp khởi động MBR.

- MBR
  - MBR viết tắt của Master Boot Record
  - Vị trí của nó nằm trong sector thứ nhất của đĩa khởi động. Thường là /dev/hda hoặc /dev/sda
  - MBR có ít hơn 512 bytes kích thước. Nó có 3 thành phần 1 là thông tin boot loader từ 1 đến 446 bytes, hai là bảng phân vùng trong 64 byte tiếp theo,3 mbr thẩm định kiểm tra trong 2 byte cuối cùng.
  - Nó chứa thông tin về GRUB (hoặc LILO trong old systems)
  => MRD tải và thực thi các bộ nạp khởi động GFUB
- GRUB
  - GRUB viết tắt của Grand Unified Bootloader.
  - Nếu bạn có nhiều kernel imager được cài đặt trên hệ thống của bạn, bạn cần chọn một cái thực thi
  - GRUB sẽ hiển thị một splash trên màn hình, đợi trong một vài dây, nếu bạn không chọn bất cứ thứ gì, nó sẽ tải imager kernel mặc định được xác định trong file cấu hình grub.
  - GRUB cấu hình trong file /boot/grub/grub.conf 
  
  => GRUB chỉ tải và thực thi kernel và initrd images.
  
- Kernel
  -  Mounts hệ thống tập tin được chỉ định trong "root=" trong file grub.conf
  - Kernel thực thi chương trình trong /sbin/init.
  - Từ khi init là một chương trình được thực thi bởi kernel, nó có id process (PID) 
  - initrd sử dụng bởi kernel như file hệ thống tập tin gốc tạm thời cho đến khi kernel được khởi động và hệ thống tập tin được mount. Nó cũng chứa những driver cần thết bên trong, mà giúp cho việc kết nối với phân vùng ổ cứng, và các phần cứng khác.
  
- Init
  - Nhìn thấy trong file /etc/initab quyết định Linux run level
  - Dưới đây là một số trạng thái của run level
    - 0: tạm dừng
    - 1: chế độ một user
    - 2: nhiều user, không có NFS
    - 3: tất cả chế độ nhiều người dùng
    - 4: không dùng
    - 5: X11
    - 6: reboot
  - Init xác định initlevel mặc định từ /etc/initab và sử dụng để tải tất cả các chương trình được tích hợp.
  - Thực thi ' grep initdefault /etc/initab' trên hệ thống của bạn xác định chức năng mặc định chạy.

- Runlevel programs
  - Khi hệ thống linux của bạn được bật khởi động, bạn có thể nhìn được các dịch vụ đang được khởi động. Những cái đó là chương trình runlevel, thực hiện từ chạy từ các level thư mục được định nghĩa từ run level của bạn
  



## System init (ialization)- process id 1

Trong các hệ điều hành máy tính dựa trên linux, init (viết tắt của initialization) là tiến trình đầu tiên được bắt đầu trong quá trình khởi động hệ thống máy tính. Init là một deamon luôn chạy cho đên khi hệ thống tắt. Nó là tiến trình cha trự tiếp hoặc gián tiếp của tất cả các tiến trình khac và tự động chấp nhận tất cả các tiến trình. Init thường được gán định danh tiến trình là 1.

## init default and runlevel

## what is runlevels, runlevel configuration

## sysinit script

## deamin or demon

## what is service

## init file and systemd

## systemd service

## work hard with systemd
